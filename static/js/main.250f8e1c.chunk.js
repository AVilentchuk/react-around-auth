(this["webpackJsonparound-react"]=this["webpackJsonparound-react"]||[]).push([[0],{17:function(e,t,n){},20:function(e,t,n){},21:function(e,t,n){"use strict";n.r(t);var a=n(1),c=n.n(a),r=n(12),o=n.n(r),i=n(7),s=(n(17),n(4)),u=n.n(s),l=n(5),d=n(2),b=c.a.createContext(),p=n(3),f=n(8),j=n(9),m=function(e,t){return fetch(e,t).then((function(e){return e.ok?e.json():Promise.reject("Failed with status:( ".concat(e.status," ").concat(e.statusText," )"))}))},h=new(function(){function e(t){var n=t.groupId,a=t.apiKey,c=t.baseUrl;Object(f.a)(this,e),this.groupId=n,this.apiKey=a,this.baseUrl=c}return Object(j.a)(e,[{key:"getInitialCards",value:function(){return m("".concat(this.baseUrl).concat(this.groupId,"/cards"),{headers:{authorization:"".concat(this.apiKey),"Content-Type":"application/json"}})}},{key:"postNewCard",value:function(e){return m("".concat(this.baseUrl).concat(this.groupId,"/cards/"),{method:"POST",headers:{authorization:"".concat(this.apiKey),"Content-Type":"application/json"},body:JSON.stringify({name:"".concat(e.name),link:"".concat(e.link)})})}},{key:"deleteCardPost",value:function(e){return m("".concat(this.baseUrl).concat(this.groupId,"/cards/").concat(e),{method:"DELETE",headers:{authorization:"".concat(this.apiKey)}})}},{key:"getProfile",value:function(){return m("".concat(this.baseUrl).concat(this.groupId,"/users/me"),{headers:{authorization:"".concat(this.apiKey)}})}},{key:"updateProfile",value:function(e){var t=e.name,n=e.about;return m("".concat(this.baseUrl).concat(this.groupId,"/users/me"),{method:"PATCH",headers:{authorization:"".concat(this.apiKey),"Content-Type":"application/json"},body:JSON.stringify({name:"".concat(t),about:"".concat(n),_id:"".concat(this.apiKey),cohort:"".concat(this.groupId)})})}},{key:"updateProfilePhoto",value:function(e){return m("".concat(this.baseUrl).concat(this.groupId,"/users/me/avatar"),{method:"PATCH",headers:{authorization:"".concat(this.apiKey),"Content-Type":"application/json"},body:JSON.stringify({avatar:"".concat(e)})})}},{key:"likePhoto",value:function(e){return m("".concat(this.baseUrl).concat(this.groupId,"/cards/likes/").concat(e),{method:"PUT",headers:{authorization:"".concat(this.apiKey)}})}},{key:"dislikePhoto",value:function(e){return m("".concat(this.baseUrl).concat(this.groupId,"/cards/likes/").concat(e),{method:"Delete",headers:{authorization:"".concat(this.apiKey)}})}}]),e}())({baseUrl:"https://around.nomoreparties.co/v1/",apiKey:"69483cc0-2fd4-4d47-b549-ff7c13f67c88",groupId:"group-12"}),O=n.p+"static/media/Logo_vector.e57222ff.svg",g=n(0),_=function(e){var t=e.loginStatus,n=e.handleLogout,c=e.navigate,r=e.userEmail,o=Object(a.useState)(!1),i=Object(d.a)(o,2),s=i[0],u=i[1],l=Object(a.useState)(!1),b=Object(d.a)(l,2),p=b[0],f=b[1],j=Object(a.useState)({width:window.innerWidth,height:window.innerHeight}),m=Object(d.a)(j,2),h=m[0],_=m[1],v=function(){_({width:window.innerWidth,height:window.innerHeight})},x=t?"Log out":"/login"===window.location.pathname?"Sign up":"Log in",k=Object(g.jsx)("a",{className:"link header__link",onClick:function(){t?n():"/login"===window.location.pathname?c("/register"):c("/login")},children:x}),y=Object(g.jsx)("p",{className:"header__email",children:t&&""!=r&&r}),w=s?Object(g.jsx)("button",{className:"button button_type_close-menu",type:"button","aria-label":"close top menu",onClick:function(){return u(!1)}}):Object(g.jsx)("button",{className:"button button_type_menu",type:"button","aria-label":"open top menu",onClick:function(){return u(!0)}}),C=Object(g.jsx)("div",{className:"header__link-container",children:p&&t?Object(g.jsx)(g.Fragment,{children:w}):Object(g.jsxs)(g.Fragment,{children:[y,k]})}),N=Object(g.jsxs)("div",{className:"header__mobile-container ".concat(s&&t&&"header__mobile-container_active"),children:[y,k]});return Object(a.useEffect)((function(){h.width<600?f(!0):(f(!1),u(!1)),console.log(p)}),[h]),Object(a.useEffect)((function(){return window.addEventListener("resize",v,!1),function(){window.removeEventListener("resize",v,!1)}}),[]),Object(a.useEffect)((function(){u(!1)}),[t]),Object(g.jsxs)(g.Fragment,{children:[p&&N,Object(g.jsxs)("header",{className:"header",children:[Object(g.jsx)("img",{className:"header__logo",src:O,alt:"site's logo"}),C]})]})},v=function(e){var t=e.likes,n=e.target,c=e.isOver,r=Object(a.createRef)(),o=q(),i=t.some((function(e){return e._id===n}))?"you ":"",s=Object(a.useState)(),u=Object(d.a)(s,2),l=u[0],b=u[1];Object(a.useEffect)((function(){c&&(r.current.style.top="".concat(o.y-r.current.offsetHeight,"px"),window.innerWidth<767?r.current.style.left="".concat(o.x-r.current.offsetWidth,"px"):r.current.style.left="".concat(o.x,"px"))}),[c,o,r]),Object(a.useEffect)((function(){b(i?t.length-1:t.length)}),[i,t]);var p=function(e){if(e._id!==n)return Object(g.jsxs)("div",{className:"likes__owner",children:[Object(g.jsx)("img",{className:"likes__owner-image",src:e.avatar,alt:"Profile pictue of ".concat(e.name)}),Object(g.jsx)("p",{className:"likes__owner-name",children:e.name})]},e._id)};return Object(g.jsxs)("div",{ref:r,className:"likes",children:[Object(g.jsx)("div",{className:"likes__container",children:t.length<=3?t.map((function(e){return p(e)})):t.slice(0,3).map((function(e){return p(e)}))}),l>3?Object(g.jsx)("span",{className:"likes__info",children:"".concat(i,"and ").concat(l-3," others liked this")}):Object(g.jsx)("span",{className:"likes__info",children:" ".concat(l&&i?"and ":"").concat(i,"liked this")})]})},x=function(e){var t=e.cardData,n=e.onClick,c=e.onCardLike,r=e.onCardDelete,o=Object(a.useContext)(b),i=Object(a.useState)(!1),s=Object(d.a)(i,2),u=s[0],l=s[1],p=Object(a.createRef)(),f=t.name,j=t.likes,m=t.link,h=t._id,O=j.some((function(e){return e._id===o._id})),_=Object(a.useState)(!1),x=Object(d.a)(_,2),k=x[0],y=x[1];Object(a.useEffect)((function(){y(p.current.clientWidth<p.current.scrollWidth)}),[p]);return Object(g.jsxs)("div",{className:"card",children:[t.owner._id===o._id&&Object(g.jsx)("button",{className:"button button_type_delete",type:"click",onClick:function(){return r(t)}}),Object(g.jsx)("img",{alt:f,src:m,className:"card__image",onClick:function(){return n(t)}}),Object(g.jsxs)("div",{className:"card__footer",children:[Object(g.jsx)("h2",{ref:p,className:"card__text",children:f}),Object(g.jsxs)("div",{className:"card__likes-container",onMouseLeave:function(){l(!1)},children:[j.length?Object(g.jsx)(v,{target:o._id,likes:j,isOver:u},h||null):"",Object(g.jsx)("button",{className:"button card__like-button ".concat(O&&"card__like-button_active"),id:"likebtn","aria-label":"heart icon (like)",onClick:function(){return c(h,O)},onMouseOver:function(){l(!0)}}),Object(g.jsx)("label",{className:"card__like-label",style:{visibility:j.length?"visible":"hidden"},children:j.length})]}),k&&Object(g.jsx)("div",{className:"card__overflow-tooltip",children:f})]})]})},k=n.p+"static/media/avatar_photo.15862bec.png",y=function(e){var t=e.onEditProfileClick,n=e.onAddPlaceClick,c=e.onEditAvatarClick,r=e.onEnlargeAvatarClick,o=e.onCardClick,i=e.handleCardLike,s=e.cardsData,u=e.onDeleteClick,l=Object(a.useContext)(b);return Object(g.jsx)("div",{children:Object(g.jsxs)("main",{children:[Object(g.jsxs)("section",{className:"profile",children:[Object(g.jsxs)("div",{className:"profile__photo-container",children:[Object(g.jsx)("img",{className:"profile__photo",src:l?l.avatar:k,alt:l?"Photo of ".concat(l.name):"Photo of Kristine Weiss"}),Object(g.jsxs)("div",{className:"profile__photo-buttons",children:[Object(g.jsx)("button",{className:"button button_type_edit-profile-image",onClick:c}),Object(g.jsx)("button",{className:"button button_type_enlarge-profile-image",onClick:function(){r(l)}})]})]}),Object(g.jsxs)("div",{className:"profile__description",children:[Object(g.jsx)("h1",{className:"profile__name",children:l?l.name:"Kristine Weiss"}),Object(g.jsx)("button",{className:"button profile__button-edit",type:"button","aria-label":"Edit profile",onClick:t}),Object(g.jsx)("p",{className:"profile__about",children:l?l.about:"Travel guide, food enthusiastic and culture lover"})]}),Object(g.jsx)("button",{className:"button profile__button-add",type:"button","aria-label":"Add or create new profile",onClick:n})]}),Object(g.jsx)("section",{className:"locations",children:s.map((function(e){return t=e,Object(g.jsx)(x,{onClick:o,cardData:t,onCardLike:i,onCardDelete:u},t._id);var t}))})]})})},w=function(){return Object(g.jsx)("div",{children:Object(g.jsx)("footer",{className:"footer",children:Object(g.jsx)("p",{className:"footer__about",children:"\xa9 2021 Around The U.S."})})})},C=function(e){var t=e.navigation,n=e.targetObj,a=e.isOpen,c=e.onClose,r=e.id,o=e.useKey,i=e.goLeft,s=e.goRight,u=[Object(g.jsx)("div",{className:"navigation-arrow navigation-arrow_left",onClick:i},"leftNav"),Object(g.jsx)("div",{className:"navigation-arrow navigation-arrow_right",onClick:s},"rightNav")];return o("ArrowRight",s,a),o("ArrowLeft",i,a),o("Escape",c,a),Object(g.jsx)("div",{className:"popup popup_gallery ".concat(a?"popup_active":""),onClick:c,children:Object(g.jsxs)("div",{className:"popup__gallery",id:r,onClick:function(e){e.stopPropagation()},children:[Object(g.jsx)("button",{className:"button button_type_close",type:"button","aria-label":"Close window",onClick:c}),Object(g.jsx)("img",{className:"popup__img",src:n?n.link?n.link:n.avatar?n.avatar:"":null,alt:n?n.name:null}),Object(g.jsx)("h2",{className:"popup__place-name",children:n?n.name:null}),t&&u]})})},N=function(){function e(t,n){var a=this;Object(f.a)(this,e),this.resetValidation=function(){var e=a._settings.inputStatus;return a._inputList.forEach((function(t){a._deactivateError(t),t.classList.remove("".concat(e))})),a._controlSubmit(!0),a._element},this._deactivateError=function(e){var t=e.nextElementSibling;t.classList.remove(a._settings.inputErrorActive),t.textContent=""},this._activateError=function(e,t){var n=e.nextElementSibling;n.classList.add(a._settings.inputErrorActive),n.textContent=t},this._controlSubmit=function(e){var t=a._settings,n=t.submitSelector,c=t.disabledButton,r=a._formElement.querySelector(".".concat(n));e?(r.classList.add(c),r.setAttribute("disabled",!0)):(r.classList.remove(c),r.removeAttribute("disabled"))},this._checkIfInputValid=function(e){var t=e.target;t.classList.add(a._settings.inputStatus),t.validity.valid?a._deactivateError(t):a._activateError(t,t.validationMessage);var n=a._inputList.some((function(e){return!e.validity.valid}));return a._controlSubmit(n)},this._setEventListeners=function(){var e=a._settings.formInput;return a._inputList=Array.from(a._formElement.querySelectorAll(".".concat(e))),a._formElement.addEventListener("submit",(function(e){e.preventDefault()})),a._formElement.addEventListener("reset",a.resetValidation),a._inputList.forEach((function(e){e.addEventListener("input",a._checkIfInputValid)})),a._element},this._settings=Object.assign({formInput:"form__input",inputStatus:"form__input_status",submitSelector:"button_type_submit",disabledButton:"button_disabled",inputErrorActive:"form__input-error_active"},n),this._formElement=t}return Object(j.a)(e,[{key:"enableValidation",value:function(){return this._setEventListeners()}}]),e}();function S(e,t,n){if(e.split(" ").length>1){var a=e.split(" ");return/\w*e\b/.test(a[0])?/\w*e\b/.exec(a[0]).toString().replace(/\w\b/,t):n.textContent.toString().split(" ")[0]+t+" "+n.textContent.toString().split(" ")[1]}return/\w*e\b/.test(e)?/\w*e\b/.exec(e).toString().replace(/\w\b/,t):n.textContent.toString()+t}var E=function(e){var t=e.dots,n=e.completeTimeDelay,a=e.buttonSelector,c=e.clickHandler,r=e.callbackEnd,o=void 0===r?function(){}:r,i=e.onError,s=void 0===i?function(){}:i,u=e.onSuccess,l=void 0===u?function(){}:u,d=e.element,b=e.successMessage,p=e.failMessage,f=t.interval,j=t.count,m=a;m&&m.setAttribute("disabled",!0);var h=m.textContent.toString();console.log(h,h.split(" ").length,m.textContent.toString().split(" ")[0]);var O=S(h,"ing",m),g=S(h,"ed",m),_=d||m;_.textContent=O;var v=setInterval((function(){_.textContent=_.textContent.length>O.length+j?"".concat(O):_.textContent+"."}),f);c().then((function(e){clearInterval(v),_.textContent=d?b:"".concat(g," successfully"),setTimeout((function(){l()}),n)})).catch((function(e){_.textContent=p||"Failed",setTimeout((function(){s(e)}),n),clearInterval(v)})).finally((function(){setTimeout((function(){o()}),3*n),setTimeout((function(){_.textContent="".concat(h),m&&m.removeAttribute("disabled")}),2*n)}))},L=function(e){var t=e.children,n=e.formName,c=e.formHeader,r=e.onClose,o=e.id,i=e.isOpen,s=e.onSubmit,u=e.validate,l=e.buttonText,b=Object(a.useState)(),p=Object(d.a)(b,2),f=p[0],j=p[1],m=Object(a.useRef)(),h=Object(a.useRef)();return Object(a.useEffect)((function(){if(u){var e=new N(m.current);e.enableValidation(),j(e)}else m.current.style.margin="0 auto"}),[u]),Object(a.useEffect)((function(){f&&i&&f.resetValidation()}),[i,f]),Object(g.jsx)("div",{className:"popup ".concat(i?"popup_active":""),onClick:r,children:Object(g.jsxs)("div",{className:"popup__window",id:o,onClick:function(e){e.stopPropagation()},children:[Object(g.jsx)("button",{className:"button button_type_close",type:"button","aria-label":"Close window",onClick:r}),Object(g.jsx)("h2",{className:"popup__title",children:c}),Object(g.jsxs)("form",{className:"form",ref:m,name:"".concat(n),onSubmit:function(e){e.preventDefault(),E({dots:{interval:75,count:4},completeTimeDelay:400,buttonSelector:h.current,clickHandler:function(){return s()},onSuccess:function(){r()}})},children:[t,Object(g.jsx)("button",{className:"button button_type_submit",type:"submit",ref:h,children:l})]})]})})},P=function(e){var t=e.isOpen,n=e.onClose,c=e.updateCurrentUser,r=e.useKey,o=Object(a.useState)(""),i=Object(d.a)(o,2),s=i[0],u=i[1],l=Object(a.useState)(""),p=Object(d.a)(l,2),f=p[0],j=p[1],m=Object(a.useContext)(b);Object(a.useEffect)((function(){t&&(u(m.name),j(m.about))}),[m,t]);return r("Escape",n,t),Object(g.jsxs)(L,{isOpen:t,onClose:n,windowId:"w-edit",formHeader:"Edit Profile",formName:"editWindow",onSubmit:function(){return c(Object.assign({},m,{name:s,about:f}))},validate:!0,buttonText:"Save",children:[Object(g.jsxs)("label",{htmlFor:"name",className:"form__field",children:[Object(g.jsx)("input",{className:"form__input",type:"text",name:"name",id:"name",value:s||"",placeholder:"Insert name here...",required:!0,minLength:"2",maxLength:"40",onChange:function(e){return u(e.target.value)}}),Object(g.jsx)("span",{className:"form__input-error"})]}),Object(g.jsxs)("label",{htmlFor:"about",className:"form__field",children:[Object(g.jsx)("input",{className:"form__input",type:"text",name:"about",id:"about",value:f||"",placeholder:"Insert job here...",required:!0,minLength:"2",maxLength:"200",onChange:function(e){return j(e.target.value)}}),Object(g.jsx)("span",{className:"form__input-error"})]})]})},I=function(e){var t=e.isOpen,n=e.onClose,c=e.updateCurrentUser,r=e.useKey,o=Object(a.useContext)(b),i=Object(a.useRef)();Object(a.useEffect)((function(){t&&(i.current.value=o.avatar)}),[o,t]);return r("Escape",n,t),Object(g.jsx)(L,{isOpen:t,onClose:n,windowId:"w-editpic",formHeader:"Change profile picture",formName:"editprofpic",onSubmit:function(){return c(Object.assign({},o,{avatar:i.current.value}))},validate:!0,buttonText:"Update",children:Object(g.jsxs)("label",{htmlFor:"pictureurl",className:"form__field",children:[Object(g.jsx)("input",{ref:i,className:"form__input",type:"url",name:"avatar",id:"pictureurl",placeholder:"insert url for picture",required:!0}),Object(g.jsx)("span",{className:"form__input-error"})]})})},T=function(e){var t=e.isOpen,n=e.onClose,c=e.addNewCard,r=e.useKey,o=Object(a.useState)(""),i=Object(d.a)(o,2),s=i[0],u=i[1],l=Object(a.useState)(""),b=Object(d.a)(l,2),p=b[0],f=b[1];return Object(a.useEffect)((function(){t&&(u(""),f(""))}),[t]),r("Escape",n,t),Object(g.jsxs)(L,{isOpen:t,onClose:n,windowId:"w-add",formHeader:"New place",formName:"addWindow",onSubmit:function(){return c({name:s,link:p})},validate:!0,buttonText:"Add",children:[Object(g.jsxs)("label",{htmlFor:"place-title",className:"form__field",children:[Object(g.jsx)("input",{className:"form__input",type:"text",name:"name",id:"place-title",placeholder:"Title",value:s,required:!0,minLength:"1",maxLength:"30",onChange:function(e){return u(e.target.value)}}),Object(g.jsx)("span",{className:"form__input-error"})]}),Object(g.jsxs)("label",{htmlFor:"image-link",className:"form__field",children:[Object(g.jsx)("input",{className:"form__input",type:"url",name:"link",id:"image-link",placeholder:"Image link",value:p,required:!0,onChange:function(e){return f(e.target.value)}}),Object(g.jsx)("span",{className:"form__input-error"})]})]})},A=function(e){var t=e.isOpen,n=e.onClose,a=e.confirmDelete;return Object(g.jsx)(L,{formName:"confirmForm",isOpen:t,id:"w-confirm",onClose:n,formHeader:"Are you sure?",onSubmit:function(){return a()},validate:!1,buttonText:"Delete"})},D="https://register.nomoreparties.co",K=function(){if(null!=localStorage.getItem("jwt"))return fetch("".concat(D,"/users/me"),{method:"GET",headers:{Accept:"application/json","Content-Type":"application/json",Authorization:"Bearer ".concat(localStorage.getItem("jwt"))}}).then(function(){var e=Object(l.a)(u.a.mark((function e(t){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,t.json();case 3:return e.abrupt("return",e.sent);case 6:e.prev=6,e.t0=e.catch(0),console.log(e.t0);case 9:case"end":return e.stop()}}),e,null,[[0,6]])})));return function(t){return e.apply(this,arguments)}}())},F=function(e){var t=e.onClose,n=e.isOpen,c=e.id,r=e.status,o=e.statusMessage,i=Object(g.jsx)("svg",{className:"tooltip_spinner",children:Object(g.jsx)("circle",{cx:"60",cy:"60",r:"54"})}),s=Object(a.useState)(o),u=Object(d.a)(s,2),l=u[0],b=u[1];return Object(a.useEffect)((function(){null===r&&b(o),r?b("Success! You have now been ".concat(o,".")):!1===r&&b("Oops, something went wrong! Please try again.  \n Error: ".concat(o,"."))}),[o,r]),Object(g.jsx)("div",{className:"popup ".concat(n?"popup_active":""," "),onClick:t,children:Object(g.jsxs)("div",{className:"popup__window",id:c,onClick:function(e){e.stopPropagation()},children:[Object(g.jsx)("button",{className:"button button_type_close",type:"button","aria-label":"Close win dow",onClick:t}),Object(g.jsx)("div",{className:"tooltip ".concat(r?"tooltip_success":!1===r?"tooltip_failure":void 0," "),children:null===r&&i}),Object(g.jsx)("h2",{className:"popup__title popup__title_tooltip",style:{margin:"0px auto 50px",textAlign:"center"},children:l})]})})},U=function(e){var t=e.handleLogin,n=e.onClose,c=e.onOpen,r=e.isOpen,o=e.checkLoggedIn,s=e.loginStatus,b=Object(a.useState)(""),p=Object(d.a)(b,2),f=p[0],j=p[1],m=Object(a.useState)(""),h=Object(d.a)(m,2),O=h[0],_=h[1],v=Object(a.useState)(null),x=Object(d.a)(v,2),k=x[0],y=x[1],w=Object(a.useState)(),C=Object(d.a)(w,2),S=C[0],L=C[1],P=Object(a.useState)("Loading"),I=Object(d.a)(P,2),T=I[0],A=I[1],K=Object(a.useRef)(),U=Object(a.createRef)(),R=function(e){return function(e,t){return fetch("".concat(D,"/signin"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:e,password:t})}).then((function(e){return e.ok?e.json():Promise.reject(e)})).then((function(e){return localStorage.setItem("jwt",e.token),e})).catch((function(e){return Promise.reject(e)}))}(f,O).then((function(e){e.token&&(j(" "),_(" "))})).catch(function(){var e=Object(l.a)(u.a.mark((function e(t){var n;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.json();case 2:return n=e.sent,e.abrupt("return",Promise.reject(n.message||n.error));case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())};return Object(a.useEffect)((function(){return s&&(A("Already Logged in, Redirecting.."),c(),setTimeout((function(){o()}),1e3)),function(){n()}}),[s]),Object(a.useEffect)((function(){var e=new N(K.current,{submitSelector:"button_type_submit-dark"});e.enableValidation(),L(e)}),[]),Object(g.jsxs)(g.Fragment,{children:[Object(g.jsxs)("div",{className:"login",children:[Object(g.jsx)("h2",{className:"page__title",children:"Log in"}),Object(g.jsxs)("form",{onSubmit:function(e){e.preventDefault(),c(),A("Logging in"),y(null),E({dots:{interval:75,count:4},completeTimeDelay:500,buttonSelector:U.current,clickHandler:R,onSuccess:function(){A("Logged in"),y(!0),t(f)},onError:function(e){console.log(e),A(e),y(!1)},callbackEnd:function(){n(),S.resetValidation()}})},className:"form form_dark",ref:K,children:[Object(g.jsxs)("label",{htmlFor:"email",className:"form__field",children:[Object(g.jsx)("input",{className:"form__input form__input_dark",required:!0,id:"email",name:"email",type:"email",placeholder:"Email",value:f||"",onChange:function(e){j(e.target.value)}}),Object(g.jsx)("span",{className:"form__input-error"})]}),Object(g.jsxs)("label",{htmlFor:"password",className:"form__field",children:[Object(g.jsx)("input",{className:"form__input form__input_dark",required:!0,id:"password",name:"password",type:"password",minLength:"6",maxLength:"10",placeholder:"Password",value:O||"",onChange:function(e){_(e.target.value),console.log(O)}}),Object(g.jsx)("span",{className:"form__input-error"})]}),Object(g.jsx)("button",{type:"submit",className:"button button_type_submit-dark button_disabled",disabled:!0,ref:U,children:"Log in"})]}),Object(g.jsxs)("p",{className:"page__caption",children:["Not a member yet? \xa0",Object(g.jsx)(i.b,{to:"/register",className:"page__caption button",children:"Sign up here!"})]})]}),Object(g.jsx)(F,{onClose:n,isOpen:r,status:k,statusMessage:T})]})},R=(n(20),function(e){var t=e.handleRegister,n=e.onOpen,c=e.onClose,r=e.isOpen,o=e.checkLoggedIn,s=e.loginStatus,b=Object(a.useState)(""),p=Object(d.a)(b,2),f=p[0],j=p[1],m=Object(a.useState)(""),h=Object(d.a)(m,2),O=h[0],_=h[1],v=Object(a.useState)(null),x=Object(d.a)(v,2),k=x[0],y=x[1],w=Object(a.useState)("Loading"),C=Object(d.a)(w,2),S=C[0],L=C[1],P=Object(a.useState)(),I=Object(d.a)(P,2),T=I[0],A=I[1],K=Object(a.useRef)(),U=Object(a.createRef)(),R=function(e){return function(e,t){return fetch("".concat(D,"/signup"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:e,password:t})}).then((function(e){return e.ok?e.json():Promise.reject(e)})).catch((function(e){return Promise.reject(e)}))}(f,O).then((function(e){console.log(e),e.ok&&t()})).catch(function(){var e=Object(l.a)(u.a.mark((function e(t){var n;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,t.json();case 2:return n=e.sent,e.abrupt("return",Promise.reject(n.message||n.error));case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}())};return Object(a.useEffect)((function(){return s&&(L("Already Logged in, Redirecting.."),n(),setTimeout((function(){o()}),1e3)),function(){c()}}),[s]),Object(a.useEffect)((function(){var e=new N(K.current,{submitSelector:"button_type_submit-dark"});e.enableValidation(),A(e)}),[]),Object(g.jsxs)(g.Fragment,{children:[Object(g.jsxs)("div",{className:"register",children:[Object(g.jsx)("p",{className:"page__title",children:"Sign Up"}),Object(g.jsxs)("form",{onSubmit:function(e){e.preventDefault(),n(),L("Registering"),y(null),E({dots:{interval:75,count:4},completeTimeDelay:500,buttonSelector:U.current,clickHandler:R,onSuccess:function(){L("Registered"),y(!0)},onError:function(e){L(e),y(!1)},callbackEnd:function(){c(),T.resetValidation()}})},className:"form form_dark",ref:K,children:[Object(g.jsxs)("label",{htmlFor:"email",className:"form__field",children:[Object(g.jsx)("input",{className:"form__input form__input_dark",placeholder:"Email",id:"email",name:"email",type:"email",value:f,required:!0,onChange:function(e){j(e.target.value)}}),Object(g.jsx)("span",{className:"form__input-error"})]}),Object(g.jsxs)("label",{htmlFor:"email",className:"form__field",children:[Object(g.jsx)("input",{className:"form__input form__input_dark",placeholder:"Password",id:"password",name:"password",type:"password",minLength:"6",maxLength:"10",required:!0,value:O,onChange:function(e){_(e.target.value)}})," ",Object(g.jsx)("span",{className:"form__input-error"})]}),Object(g.jsx)("button",{type:"submit",className:"button button_type_submit-dark button_disabled",disabled:!0,ref:U,children:"Sign up"})]}),Object(g.jsxs)("p",{className:"page__caption",children:["Already have an account? \xa0",Object(g.jsx)(i.b,{to:"/login",className:"page__caption button",children:"Log in here!"})]})]}),Object(g.jsx)(F,{onClose:c,isOpen:r,status:k,statusMessage:S})]})}),H=function(e){var t=e.children;return K()?t:Object(g.jsx)(p.a,{to:"/login"})},q=function(){var e=Object(a.useState)({x:0,y:0}),t=Object(d.a)(e,2),n=t[0],c=t[1];return Object(a.useEffect)((function(){var e=function(e){return c({x:e.clientX,y:e.clientY})};return window.addEventListener("mousemove",e),function(){window.removeEventListener("mousemove",e)}}),[]),n};var z=function(){var e=Object(a.useState)(!1),t=Object(d.a)(e,2),n=t[0],c=t[1],r=Object(a.useState)(!1),o=Object(d.a)(r,2),i=o[0],s=o[1],f=Object(a.useState)(!1),j=Object(d.a)(f,2),m=j[0],O=j[1],v=Object(a.useState)(!1),x=Object(d.a)(v,2),k=x[0],N=x[1],S=Object(a.useState)(!1),E=Object(d.a)(S,2),L=E[0],D=E[1],F=Object(a.useState)(!1),q=Object(d.a)(F,2),z=q[0],V=q[1],W=Object(a.useState)(!1),M=Object(d.a)(W,2),J=M[0],B=M[1],Y=Object(a.useState)({}),G=Object(d.a)(Y,2),X=G[0],Q=G[1],Z=Object(a.useState)({}),$=Object(d.a)(Z,2),ee=$[0],te=$[1],ne=Object(a.useState)([]),ae=Object(d.a)(ne,2),ce=ae[0],re=ae[1],oe=Object(a.useState)(!1),ie=Object(d.a)(oe,2),se=ie[0],ue=ie[1],le=Object(a.useState)(""),de=Object(d.a)(le,2),be=de[0],pe=de[1];function fe(e,t,n){var c=Object(a.useRef)(t);Object(a.useEffect)((function(){c.current=t})),Object(a.useEffect)((function(){if(n)return document.addEventListener("keydown",t),function(){return document.removeEventListener("keydown",t)};function t(t){t.code===e&&c.current(t)}}),[e,n])}var je=function(){var e=Object(l.a)(u.a.mark((function e(){var t;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,h.getProfile();case 3:(t=e.sent)&&te(t),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.log(e.t0);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(){return e.apply(this,arguments)}}(),me=function(){var e=Object(l.a)(u.a.mark((function e(){var t;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,h.getInitialCards();case 3:(t=e.sent)&&re(t),e.next=10;break;case 7:e.prev=7,e.t0=e.catch(0),console.log(e.t0);case 10:case"end":return e.stop()}}),e,null,[[0,7]])})));return function(){return e.apply(this,arguments)}}(),he=function(){var e=Object(l.a)(u.a.mark((function e(t,n){var a,c;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!n){e.next=13;break}return e.prev=1,e.next=4,h.dislikePhoto(t).then((function(e){return ce.map((function(t){return e._id===t._id?e:t}))}));case 4:a=e.sent,re(a),e.next=11;break;case 8:e.prev=8,e.t0=e.catch(1),console.log(e.t0);case 11:e.next=23;break;case 13:return e.prev=13,e.next=16,h.likePhoto(t).then((function(e){return ce.map((function(t){return e._id===t._id?e:t}))}));case 16:c=e.sent,re(c),e.next=23;break;case 20:e.prev=20,e.t1=e.catch(13),console.log(e.t1);case 23:case"end":return e.stop()}}),e,null,[[1,8],[13,20]])})));return function(t,n){return e.apply(this,arguments)}}(),Oe=function(){var e=Object(l.a)(u.a.mark((function e(){var t;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return t=X._id,e.prev=1,e.next=4,h.deleteCardPost(t);case 4:return e.abrupt("return",re(ce.filter((function(e){return e._id!==t}))));case 7:return e.prev=7,e.t0=e.catch(1),e.abrupt("return",Promise.reject(e.t0));case 10:case"end":return e.stop()}}),e,null,[[1,7]])})));return function(){return e.apply(this,arguments)}}(),ge=function(){var e=Object(l.a)(u.a.mark((function e(t){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,h.postNewCard(t).then((function(e){return re((function(t){return[e].concat(t)}))})).catch((function(e){return Promise.reject(e)}));case 3:e.next=8;break;case 5:return e.prev=5,e.t0=e.catch(0),e.abrupt("return",Promise.reject(e.t0));case 8:case"end":return e.stop()}}),e,null,[[0,5]])})));return function(t){return e.apply(this,arguments)}}(),_e=function(){D(!1),N(!1),O(!1),s(!1),c(!1),V(!1),B(!1)},ve=function(){var e=Object(l.a)(u.a.mark((function e(t){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.abrupt("return",h.updateProfile(t).then((function(e){te(e)})).catch((function(e){return Promise.reject(e)})));case 4:return e.prev=4,e.t0=e.catch(0),e.abrupt("return",Promise.reject(e.t0));case 7:case"end":return e.stop()}}),e,null,[[0,4]])})));return function(t){return e.apply(this,arguments)}}(),xe=function(){var e=Object(l.a)(u.a.mark((function e(t){return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,h.updateProfilePhoto(t.avatar).then((function(e){te(e)})).catch((function(e){return Promise.reject(e)}));case 3:return e.abrupt("return",e.sent);case 6:return e.prev=6,e.t0=e.catch(0),e.abrupt("return",Promise.reject(e.t0));case 9:case"end":return e.stop()}}),e,null,[[0,6]])})));return function(t){return e.apply(this,arguments)}}(),ke=function(){var e=ce.findIndex((function(e){return e===X}));e=parseInt(e-1)>=0?parseInt(e-1):ce.length-1,Q(ce[e])},ye=function(){var e=ce.findIndex((function(e){return e===X}));e=parseInt(e+1)<=ce.length-1?parseInt(e+1):0,Q(ce[e])},we=function(e){B(!0)},Ce=Object(p.g)(),Ne=function(){se&&Ce("/")};return Object(a.useEffect)(Object(l.a)(u.a.mark((function e(){var t;return u.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,K();case 2:if(t=e.sent)try{pe(t.data.email),ue(!0),console.log(be)}catch(n){console.log(n)}else"/"===window.location.pathname&&Ce("/login");case 4:case"end":return e.stop()}}),e)}))),[]),Object(a.useEffect)((function(){me(),je()}),[]),Object(g.jsx)("div",{className:"page",children:Object(g.jsxs)("div",{className:"page__wrap",children:[Object(g.jsx)(_,{userEmail:be,loginStatus:se,handleLogout:function(){localStorage.clear(),ue(!1),Ce("/login")},navigate:Ce}),Object(g.jsx)(b.Provider,{value:ee,children:Object(g.jsxs)(p.d,{children:[Object(g.jsx)(p.b,{path:"/register",element:Object(g.jsx)(R,{loginStatus:se,checkLoggedIn:Ne,onClose:_e,isOpen:J,onOpen:we,navigate:Ce})}),Object(g.jsx)(p.b,{path:"/login",element:Object(g.jsx)(U,{loginStatus:se,checkLoggedIn:Ne,handleLogin:function(e){e&&console.log(e),ue(!0),Ce("/"),e&&pe(e)},setUser:pe,onClose:_e,isOpen:J,onOpen:we})}),Object(g.jsx)(p.b,{path:"/",element:Object(g.jsxs)(H,{children:[Object(g.jsx)(y,{onEditProfileClick:function(){c(!0)},onAddPlaceClick:function(){s(!0)},onEditAvatarClick:function(){O(!0)},onEnlargeAvatarClick:function(e){te(e),N(!0)},onCardClick:function(e){Q(e),D(!0)},setUserData:ve,handleCardLike:he,onDeleteClick:function(e){Q(e),V(!0)},cardsData:ce}),Object(g.jsx)(P,{isOpen:n,onClose:_e,updateCurrentUser:ve,useKey:fe}),Object(g.jsx)(T,{isOpen:i,onClose:_e,addNewCard:ge,useKey:fe}),Object(g.jsx)(I,{isOpen:m,onClose:_e,updateCurrentUser:xe,useKey:fe}),Object(g.jsx)(C,{isOpen:L,onClose:_e,id:"w-img",targetObj:X,navigation:!0,useKey:fe,goLeft:ke,goRight:ye}),Object(g.jsx)(C,{isOpen:k,onClose:_e,id:"w-piclrg",targetObj:ee,navigation:!1,useKey:fe,goLeft:ke,goRight:ye}),Object(g.jsx)(A,{isOpen:z,onClose:_e,confirmDelete:Oe})]})})]})}),Object(g.jsx)(w,{})]})})},V=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,22)).then((function(t){var n=t.getCLS,a=t.getFID,c=t.getFCP,r=t.getLCP,o=t.getTTFB;n(e),a(e),c(e),r(e),o(e)}))};o.a.render(Object(g.jsx)(i.a,{children:Object(g.jsx)(z,{})}),document.getElementById("root")),V()}},[[21,1,2]]]);
//# sourceMappingURL=main.250f8e1c.chunk.js.map